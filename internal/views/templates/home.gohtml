{{template "base" .}}

{{define "body"}}
<div class="card">
  <h1>Recent Posts</h1>
  <form method="GET" action="/">
    <div style="display:flex;gap:.5rem;flex-wrap:wrap;">
      <label style="min-width:220px;">
        <span>Category</span>
        <select name="category">
          <option value="">-- All --</option>
          {{range .Categories}}
            <option value="{{.Slug}}" {{if eq $.FilterCategory .Slug}}selected{{end}}>{{.Name}}</option>
          {{end}}
        </select>
      </label>
      <label><input type="checkbox" name="mine" value="1" {{if .FilterMine}}checked{{end}}> My posts</label>
      <label><input type="checkbox" name="liked" value="1" {{if .FilterLiked}}checked{{end}}> My liked posts</label>
      <button class="btn btn-primary" type="submit">Apply</button>
    </div>
  </form>
</div>

{{if not .Posts}}
  <div class="card">No posts yet. Be the first to <a href="/post/new">create one</a>!</div>
{{end}}

{{range .Posts}}
  <article class="card">
    <header style="display:flex;justify-content:space-between;gap:.5rem;align-items:center;">
      <h2 style="margin:0;"><a href="/post/{{.ID}}">{{.Title}}</a></h2>
      <div class="small">by <strong>{{.Author}}</strong> &middot; {{formatTime .CreatedAt}}</div>
    </header>
    <div class="small" style="margin:.25rem 0;">
      {{range .Categories}}<span class="tag">{{.Slug}}</span>{{end}}
    </div>
    <footer class="small">
      <span class="counter">▲ {{.Likes}}</span>
      <span class="counter">▼ {{.Dislikes}}</span>
      &middot; <a href="/post/{{.ID}}">Open</a>
    </footer>
  </article>
{{end}}
{{end}}
