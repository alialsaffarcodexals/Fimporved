{{define "post_show.html"}}{{template "layout.html" .}}{{end}} {{/* Post detail page */}}

{{define "title"}}{{.Post.Title}}{{end}}
{{define "content"}}
<article class="card">
  <!-- Post content -->
  <h2 class="post-title">{{.Post.Title}}</h2>
  <div class="meta">by {{.Post.Username}} • {{.Post.CreatedAt}}</div>
  <p>{{.Post.Body}}</p>
  <div>
    {{range .Post.Categories}}<span class="tag">{{.}}</span>{{end}}
  </div>
  <div class="mt-8">
    <form class="inline" method="post" action="/like">
      <input type="hidden" name="type" value="post">
      <input type="hidden" name="id" value="{{.Post.ID}}">
      <input type="hidden" name="value" value="1">
      <button class="btn" type="submit">👍 {{.Post.Likes}}</button>
    </form>
    <form class="inline" method="post" action="/like">
      <input type="hidden" name="type" value="post">
      <input type="hidden" name="id" value="{{.Post.ID}}">
      <input type="hidden" name="value" value="-1">
      <button class="btn" type="submit">👎 {{.Post.Dislikes}}</button>
    </form>
  </div>
</article>

<section class="card">
  <h3 class="mt-0">Comments</h3>
  {{range .Comments}}
    <div class="card my-8">
      <div class="meta">{{.Username}} • {{.CreatedAt}}</div>
      <p>{{.Body}}</p>
      <div>
        <form class="inline" method="post" action="/like">
          <input type="hidden" name="type" value="comment">
          <input type="hidden" name="id" value="{{.ID}}">
          <input type="hidden" name="value" value="1">
          <button class="btn" type="submit">👍 {{.Likes}}</button>
        </form>
        <form class="inline" method="post" action="/like">
          <input type="hidden" name="type" value="comment">
          <input type="hidden" name="id" value="{{.ID}}">
          <input type="hidden" name="value" value="-1">
          <button class="btn" type="submit">👎 {{.Dislikes}}</button>
        </form>
      </div>
    </div>
  {{else}}
    <p>No comments yet.</p>
  {{end}}

  {{if .LoggedIn}}
  <form method="post" action="/comment/new" class="mt-12">
    <input type="hidden" name="post_id" value="{{.Post.ID}}">
    <label>Your comment</label>
    <textarea name="body" rows="4" required></textarea>
    <div class="mt-8"><button class="btn primary" type="submit">Add comment</button></div>
  </form>
  {{else}}
    <p><a href="/login">Login</a> to comment.</p>
  {{end}}
</section>
{{end}}
